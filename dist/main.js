(()=>{"use strict";var e=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;var t=Math.PI/180;function o(){var e=new r(16);return r!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});var n;function a(e,t,o){var n=new r(3);return n[0]=e,n[1]=t,n[2]=o,n}n=new r(3),r!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),console.log("starting WebGL2");const i=[0,0,1,.5,1,0,0,-1,.5,0,.71,.71,0,0,.5,.71,-.71,0,.75,.5,-.71,.71,0,.25,.5,-.71,-.71,0,.5,.5],E=[0,2,4,0,4,5,0,5,3,0,3,2,1,4,2,1,5,4,1,3,5,1,2,3];try{!function(){const r=document.getElementById("myCanvas"),n=r.getContext("webgl2");if(!n)return void console.error("ERROR::WEBGL2::INITIALIZATION_ERROR");n.clearColor(.1,.1,.1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.cullFace(n.BACK),n.frontFace(n.CCW),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);const R=n.createTexture();R.is_loaded=!1;const T=new Image;T.onload=function(){n.bindTexture(n.TEXTURE_2D,R),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,T),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),console.log("texture loaded"),R.is_loaded=!0},T.src="earthmap1k.jpg";const c=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nlayout (location = 0) in vec3 vertexPosition;\nlayout (location = 1) in vec2 vertexTexture;\n\nout vec2 st;\nout vec3 normal;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main() \n{\n    st = vertexTexture;\n    normal = vec3(uProjectionMatrix * uModelViewMatrix * vec4(vertexPosition, 0.0));\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(vertexPosition, 1.0);\n}"),n.compileShader(c),!n.getShaderParameter(c,n.COMPILE_STATUS))return void console.error("ERROR::SHADER::VERTEX::COMPILATION_FAILED\n"+n.getShaderInfoLog(c));const A=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(A,"#version 300 es\nprecision mediump float;\n\nin vec2 st;\nin vec3 normal;\n\nout vec4 outColor;\n\nuniform sampler2D uTexture;\n\nvoid main() \n{\n    vec4 texel = texture(uTexture, st);\n    outColor = texel;\n}"),n.compileShader(A),!n.getShaderParameter(A,n.COMPILE_STATUS))return void console.error("ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\n"+n.getShaderInfoLog(A));const l=n.createProgram();if(n.attachShader(l,c),n.attachShader(l,A),n.linkProgram(l),!n.getProgramParameter(l,n.LINK_STATUS))return void console.error("ERROR::SHADER::PROGRAM::LINKING_FAILED\n"+n.getProgramInfoLog(l));if(n.validateProgram(l),!n.getProgramParameter(l,n.VALIDATE_STATUS))return void console.error("ERROR::SHADER::PROGRAM::VALIDATION_FAILED\n"+n.getProgramInfoLog(l));const u=n.getUniformLocation(l,"uModelViewMatrix"),_=n.getUniformLocation(l,"uProjectionMatrix"),d=n.getUniformLocation(l,"uTexture");if(!u||!_||!d)return void console.error("ERROR::SHADER::PROGRAM::UNIFORM_LOCATION");let s=new Float32Array(i),m=new Uint16Array(E);const P=n.createVertexArray(),f=n.createBuffer(),I=n.createBuffer();P.is_loaded=!1,n.bindVertexArray(P),n.bindBuffer(n.ARRAY_BUFFER,f),n.bufferData(n.ARRAY_BUFFER,s,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,I),n.bufferData(n.ELEMENT_ARRAY_BUFFER,m,n.STATIC_DRAW),n.vertexAttribPointer(0,3,n.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,0),n.enableVertexAttribArray(0),n.vertexAttribPointer(1,2,n.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT),n.enableVertexAttribArray(1),n.bindVertexArray(null),P.is_loaded=!0,requestAnimationFrame((function i(E){r.width=r.clientWidth*devicePixelRatio,r.height=r.clientHeight*devicePixelRatio,n.clearColor(.1,.1,.1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.viewport(0,0,r.width,r.height),n.useProgram(l),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,R),n.uniform1i(d,0);const T=o(),c=o();!function(r,t,o,n){var a,i,E,R,T,c,A,l,u,_,d=t[0],s=t[1],m=t[2],P=n[0],f=n[1],I=n[2],h=o[0],x=o[1],M=o[2];Math.abs(d-h)<e&&Math.abs(s-x)<e&&Math.abs(m-M)<e?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(r):(A=d-h,l=s-x,u=m-M,a=f*(u*=_=1/Math.hypot(A,l,u))-I*(l*=_),i=I*(A*=_)-P*u,E=P*l-f*A,(_=Math.hypot(a,i,E))?(a*=_=1/_,i*=_,E*=_):(a=0,i=0,E=0),R=l*E-u*i,T=u*a-A*E,c=A*i-l*a,(_=Math.hypot(R,T,c))?(R*=_=1/_,T*=_,c*=_):(R=0,T=0,c=0),r[0]=a,r[1]=R,r[2]=A,r[3]=0,r[4]=i,r[5]=T,r[6]=l,r[7]=0,r[8]=E,r[9]=c,r[10]=u,r[11]=0,r[12]=-(a*d+i*s+E*m),r[13]=-(R*d+T*s+c*m),r[14]=-(A*d+l*s+u*m),r[15]=1)}(T,a(-4,-4,0),a(0,0,0),a(0,0,1)),function(e,r,t,o,n){var a,i=1/Math.tan(r/2);e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(a=1/(o-n),e[10]=(n+o)*a,e[14]=2*n*o*a):(e[10]=-1,e[14]=-2*o)}(c,45*t,r.width/r.height,.1,100),n.uniformMatrix4fv(u,!1,T),n.uniformMatrix4fv(_,!1,c),n.bindVertexArray(P),n.drawElements(n.TRIANGLES,24,n.UNSIGNED_SHORT,0),requestAnimationFrame(i)}))}()}catch(e){console.log(`ERROR::JS::EXCEPTION\n${e}`)}})();